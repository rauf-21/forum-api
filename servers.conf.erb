limit_req_zone $binary_remote_addr zone=one:10m rate=4r/m;

server {
  server_name localhost;
  listen <%= ENV['PORT'] %>;
  charset utf-8;
  
  location / {
    proxy_pass <%= ENV['MAIN_APP_URL'] %>;
  }
  
  location /threads {
    proxy_pass <%= ENV['MAIN_APP_URL'] %>/threads/;
    limit_req zone=one;
  }
}